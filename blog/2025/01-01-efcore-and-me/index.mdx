---
title: EFCore refactoring is here
description: EFCore, Jellyfin and me.
authors: JPVenson
slug: efcore-refactoring
tags: [unstable, warning, efcore]
---

EFCore is here and this will have consequences.

We finally reached our first milestone in cleaning up the legacy code regarding the database access, that means all sql builders that were targeting SqLite directly are now removed from code.  

This marks the first step towards a completely new Database design. But we now need to take a quick look ahead and see whats next.

Please continue to read further to see what exactly that means and what the future brings.

\- JPVenson

{/* truncate */}

## What exactly have we done

[Joshâ€™s blog post](../../2024/11-03-efcore-refactoring-incoming/index.mdx) in November 2024 outlined much of what we aimed to achieve, and I want to take this opportunity to address the feedback and questions we've received, clarifying a few key points.  

The old Emby code contained a lot of code that were directly accessing the underlying used database using SqLite. 
SqLite is a file based database where jellyfin is storing most of its important data.
This has been an issue for 3 reasons.
1. The old code was very poorly written in terms of extensibility
2. The old code was very complex
3. It was explicitly written to support SQLite only and nothing else  

Because of this, we were not able to quickly extend our database it in a reliable way. The new code uses EntityFramework migrations which is the industry standard for database migrations.  

## What haven't we done

While we are currently working on it, the current PR does __not__ add support for alternative database providers on its own. 
Other database provider will be a significant change in itself, and when introduced, it will likely remain highly experimental for quite some time.  

Very importantly, we also have not yet optimised the rest of Jellyfin to work with the new database access. That means it is quite possible that unstable builds might be significatly slower while we are rewriting the rest of the code to utilise the new structures.  



## The Future

We will soon re-enable unstable builds so you can test out the EFCore migration. 

The migration will aggregate the old `library.db` into the `jellyfin.db` file and then rename it to `library.db.old`, so the unstable builds will no longer be compatible with the previous versions.  


To migrate, we explicitly __do not support older version then 10.10.3__. That means if you want to test the migrations, you have to do so from an up-to-date database.

Thank you, and if you have questions, don't hesitate to join our matrix channel.  


\- JPVenson.